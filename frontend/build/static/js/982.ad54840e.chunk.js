"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[982],{982:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var n=i(555),r=i(424),o=i(474),s=i(722),a=i(269),l=i(579);const c=e=>{let{product:t,lines:i,onClose:o,onSave:s,language:a}=e;const[c,d]=(0,r.useState)({name:(null===t||void 0===t?void 0:t.name)||"",description:(null===t||void 0===t?void 0:t.description)||"",category:(null===t||void 0===t?void 0:t.category)||"",unit:(null===t||void 0===t?void 0:t.unit)||"\u06a4\u0627\u064a\u0644",line_id:(null===t||void 0===t?void 0:t.line_id)||"",price:(null===t||void 0===t?void 0:t.price)||"",price_type:(null===t||void 0===t?void 0:t.price_type)||"per_vial",current_stock:(null===t||void 0===t?void 0:t.current_stock)||"",min_stock:(null===t||void 0===t?void 0:t.min_stock)||10,is_active:void 0===(null===t||void 0===t?void 0:t.is_active)||t.is_active}),u=e=>{const{name:t,value:i,type:r,checked:o}=e.target;d((e=>(0,n.A)((0,n.A)({},e),{},{[t]:"checkbox"===r?o:i})))};return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsx)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-white/20",children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold",children:t?"\u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0645\u0646\u062a\u062c":"\u0625\u0636\u0627\u0641\u0629 \u0645\u0646\u062a\u062c \u062c\u062f\u064a\u062f"}),(0,l.jsx)("button",{onClick:o,className:"text-white/70 hover:text-white text-2xl",children:"\u2715"})]}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=(0,n.A)((0,n.A)({},c),{},{price:parseFloat(c.price),current_stock:parseInt(c.current_stock),min_stock:parseInt(c.min_stock)});s(t)},className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0646\u062a\u062c *"}),(0,l.jsx)("input",{type:"text",name:"name",value:c.name,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u0641\u0626\u0629 *"}),(0,l.jsx)("input",{type:"text",name:"category",value:c.category,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"\u0645\u0636\u0627\u062f\u0627\u062a \u062d\u064a\u0648\u064a\u0629\u060c \u0641\u064a\u062a\u0627\u0645\u064a\u0646\u0627\u062a\u060c \u0625\u0644\u062e",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u062e\u0637"}),(0,l.jsxs)("select",{name:"line_id",value:c.line_id,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,l.jsx)("option",{value:"",children:"\u0627\u062e\u062a\u0631 \u0627\u0644\u062e\u0637"}),i.map((e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0648\u062d\u062f\u0629 \u0627\u0644\u0642\u064a\u0627\u0633 *"}),(0,l.jsxs)("select",{name:"unit",value:c.unit,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0,children:[(0,l.jsx)("option",{value:"\u06a4\u0627\u064a\u0644",children:"\u06a4\u0627\u064a\u0644"}),(0,l.jsx)("option",{value:"\u0639\u0644\u0628\u0629",children:"\u0639\u0644\u0628\u0629"}),(0,l.jsx)("option",{value:"\u0642\u0644\u0645",children:"\u0642\u0644\u0645"}),(0,l.jsx)("option",{value:"\u0623\u0646\u0628\u0648\u0628",children:"\u0623\u0646\u0628\u0648\u0628"}),(0,l.jsx)("option",{value:"\u0632\u062c\u0627\u062c\u0629",children:"\u0632\u062c\u0627\u062c\u0629"}),(0,l.jsx)("option",{value:"\u0643\u064a\u0633",children:"\u0643\u064a\u0633"}),(0,l.jsx)("option",{value:"\u0634\u0631\u064a\u0637",children:"\u0634\u0631\u064a\u0637"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u0633\u0639\u0631 (\u062c.\u0645) *"}),(0,l.jsx)("input",{type:"number",step:"0.01",name:"price",value:c.price,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0646\u0648\u0639 \u0627\u0644\u0633\u0639\u0631"}),(0,l.jsxs)("select",{name:"price_type",value:c.price_type,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,l.jsx)("option",{value:"per_vial",children:"\u0633\u0639\u0631 \u0627\u0644\u06a4\u0627\u064a\u0644"}),(0,l.jsx)("option",{value:"per_box",children:"\u0633\u0639\u0631 \u0627\u0644\u0639\u0644\u0628\u0629"}),(0,l.jsx)("option",{value:"per_pen",children:"\u0633\u0639\u0631 \u0627\u0644\u0642\u0644\u0645"}),(0,l.jsx)("option",{value:"per_tube",children:"\u0633\u0639\u0631 \u0627\u0644\u0623\u0646\u0628\u0648\u0628"}),(0,l.jsx)("option",{value:"per_bottle",children:"\u0633\u0639\u0631 \u0627\u0644\u0632\u062c\u0627\u062c\u0629"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u062d\u0627\u0644\u064a\u0629"}),(0,l.jsx)("input",{type:"number",name:"current_stock",value:c.current_stock,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u062d\u062f \u0627\u0644\u0623\u062f\u0646\u0649 \u0644\u0644\u0645\u062e\u0632\u0648\u0646"}),(0,l.jsx)("input",{type:"number",name:"min_stock",value:c.min_stock,onChange:u,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u0648\u0635\u0641"}),(0,l.jsx)("textarea",{name:"description",value:c.description,onChange:u,rows:"3",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"\u0648\u0635\u0641 \u062a\u0641\u0635\u064a\u0644\u064a \u0644\u0644\u0645\u0646\u062a\u062c..."})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:c.is_active,onChange:u,className:"w-4 h-4 text-purple-600 rounded"}),(0,l.jsx)("label",{htmlFor:"is_active",className:"text-sm font-medium",children:"\u0645\u0646\u062a\u062c \u0646\u0634\u0637"})]}),(0,l.jsxs)("div",{className:"flex gap-3 pt-6",children:[(0,l.jsx)("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-purple-600 to-purple-700 text-white py-3 rounded-lg hover:from-purple-700 hover:to-purple-800 transition-all",children:t?"\u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0646\u062a\u062c":"\u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0646\u062a\u062c"}),(0,l.jsx)("button",{type:"button",onClick:o,className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors",children:"\u0625\u0644\u063a\u0627\u0621"})]})]})]})})})},d=e=>{let{user:t,language:i,isRTL:n}=e;const[d,u]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[g,h]=(0,r.useState)(!0),[x,v]=(0,r.useState)(!1),[b,y]=(0,r.useState)(null),[f,_]=(0,r.useState)(""),[w,j]=(0,r.useState)("all"),[N,k]=(0,r.useState)("all"),{t:A}=(0,o.Bd)(i),C="https://6fc37004-de78-473a-b926-f0438820a235.preview.emergentagent.com/api",S=t&&("admin"===t.role||"gm"===t.role||"accounting"===t.role||"finance"===t.role||["admin","gm","accounting","finance"].includes(t.role));(0,r.useEffect)((()=>{I(),P(),a.a.logSystemAccess("\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0645\u0646\u062a\u062c\u0627\u062a",{previousSection:sessionStorage.getItem("previousSection")||"",accessMethod:"navigation",canSeePrices:S}),sessionStorage.setItem("previousSection","\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0645\u0646\u062a\u062c\u0627\u062a")}),[]);const P=async()=>{try{const e=localStorage.getItem("access_token"),t=await s.A.get("".concat(C,"/lines"),{headers:{Authorization:"Bearer ".concat(e)}});p(t.data||[])}catch(e){console.error("Error fetching lines:",e),p([])}},I=async()=>{try{const e=localStorage.getItem("access_token"),t=await s.A.get("".concat(C,"/products"),{headers:{Authorization:"Bearer ".concat(e)}});u(t.data||[])}catch(e){console.error("Error fetching products:",e),u([{id:"prod-001",name:"\u0623\u0645\u0648\u0643\u0633\u064a\u0633\u064a\u0644\u064a\u0646 500mg",description:"\u0645\u0636\u0627\u062f \u062d\u064a\u0648\u064a \u0648\u0627\u0633\u0639 \u0627\u0644\u0645\u062c\u0627\u0644",category:"\u0645\u0636\u0627\u062f\u0627\u062a \u062d\u064a\u0648\u064a\u0629",unit:"\u06a4\u0627\u064a\u0644",line_id:"line-001",line_name:"\u062e\u0637 \u0627\u0644\u0642\u0627\u0647\u0631\u0629 \u0627\u0644\u0643\u0628\u0631\u0649",price:25.5,price_type:"per_vial",current_stock:150,min_stock:20,is_active:!0,created_at:"2024-01-01T10:00:00Z"},{id:"prod-002",name:"\u0641\u064a\u062a\u0627\u0645\u064a\u0646 \u062f3",description:"\u0645\u0643\u0645\u0644 \u063a\u0630\u0627\u0626\u064a \u0644\u062a\u0642\u0648\u064a\u0629 \u0627\u0644\u0639\u0638\u0627\u0645",category:"\u0641\u064a\u062a\u0627\u0645\u064a\u0646\u0627\u062a",unit:"\u0639\u0644\u0628\u0629",line_id:"line-002",line_name:"\u062e\u0637 \u0627\u0644\u0625\u0633\u0643\u0646\u062f\u0631\u064a\u0629",price:120,price_type:"per_box",current_stock:80,min_stock:15,is_active:!0,created_at:"2024-01-02T10:00:00Z"},{id:"prod-003",name:"\u0623\u0646\u0633\u0648\u0644\u064a\u0646 \u0637\u0648\u064a\u0644 \u0627\u0644\u0645\u0641\u0639\u0648\u0644",description:"\u0639\u0644\u0627\u062c \u0627\u0644\u0633\u0643\u0631\u064a \u0627\u0644\u0646\u0648\u0639 \u0627\u0644\u0623\u0648\u0644 \u0648\u0627\u0644\u062b\u0627\u0646\u064a",category:"\u0647\u0631\u0645\u0648\u0646\u0627\u062a",unit:"\u0642\u0644\u0645",line_id:"line-001",line_name:"\u062e\u0637 \u0627\u0644\u0642\u0627\u0647\u0631\u0629 \u0627\u0644\u0643\u0628\u0631\u0649",price:85,price_type:"per_pen",current_stock:45,min_stock:10,is_active:!0,created_at:"2024-01-03T10:00:00Z"}])}finally{h(!1)}},T=d.filter((e=>{var t,i;const n=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(f.toLowerCase()))||(null===(i=e.description)||void 0===i?void 0:i.toLowerCase().includes(f.toLowerCase())),r="all"===w||e.category===w,o="all"===N||e.line_id===N;return n&&r&&o})),O=[...new Set(d.map((e=>e.category)).filter(Boolean))],B=e=>e.current_stock<=e.min_stock?"critical":e.current_stock<=2*e.min_stock?"low":"good",E=e=>{switch(e){case"critical":return"bg-red-500/20 text-red-300 border-red-500/30";case"low":return"bg-yellow-500/20 text-yellow-300 border-yellow-500/30";default:return"bg-green-500/20 text-green-300 border-green-500/30"}};return g?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u0646\u062a\u062c\u0627\u062a..."})]})}):(0,l.jsxs)("div",{className:"product-management-container",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-2xl text-white",children:"\ud83d\udce6"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:A("products","title")}),(0,l.jsx)("p",{className:"text-lg opacity-75",children:"\u0625\u062f\u0627\u0631\u0629 \u0634\u0627\u0645\u0644\u0629 \u0644\u0644\u0645\u0646\u062a\u062c\u0627\u062a \u0645\u0639 \u0627\u0644\u062a\u062d\u0643\u0645 \u0641\u064a \u0627\u0644\u0623\u0633\u0639\u0627\u0631 \u0648\u0627\u0644\u0645\u062e\u0632\u0648\u0646"})]})]}),(0,l.jsxs)("button",{onClick:()=>{y(null),v(!0),console.log("\ud83d\udd27 Opening product modal for new product")},className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 font-medium",children:[(0,l.jsx)("span",{children:"\u2795"}),"\u0625\u0636\u0627\u0641\u0629 \u0645\u0646\u062a\u062c \u062c\u062f\u064a\u062f"]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,l.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:d.length}),(0,l.jsx)("div",{className:"text-sm opacity-75",children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0645\u0646\u062a\u062c\u0627\u062a"})]}),(0,l.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:d.filter((e=>e.is_active)).length}),(0,l.jsx)("div",{className:"text-sm opacity-75",children:"\u0645\u0646\u062a\u062c\u0627\u062a \u0646\u0634\u0637\u0629"})]}),(0,l.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:d.filter((e=>"critical"===B(e))).length}),(0,l.jsx)("div",{className:"text-sm opacity-75",children:"\u0645\u062e\u0632\u0648\u0646 \u062d\u0631\u062c"})]}),(0,l.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:O.length}),(0,l.jsx)("div",{className:"text-sm opacity-75",children:"\u0641\u0626\u0627\u062a \u0627\u0644\u0645\u0646\u062a\u062c\u0627\u062a"})]})]}),(0,l.jsx)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u0628\u062d\u062b"}),(0,l.jsx)("input",{type:"text",placeholder:"\u0627\u0628\u062d\u062b \u0639\u0646 \u0627\u0644\u0645\u0646\u062a\u062c\u0627\u062a...",value:f,onChange:e=>_(e.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u0641\u0626\u0629"}),(0,l.jsxs)("select",{value:w,onChange:e=>j(e.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,l.jsx)("option",{value:"all",children:"\u062c\u0645\u064a\u0639 \u0627\u0644\u0641\u0626\u0627\u062a"}),O.map((e=>(0,l.jsx)("option",{value:e,children:e},e)))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"\u0627\u0644\u062e\u0637"}),(0,l.jsxs)("select",{value:N,onChange:e=>k(e.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,l.jsx)("option",{value:"all",children:"\u062c\u0645\u064a\u0639 \u0627\u0644\u062e\u0637\u0648\u0637"}),m.map((e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]})}),(0,l.jsx)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-white/10 bg-white/5",children:[(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u0645\u0646\u062a\u062c"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u0641\u0626\u0629"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u062e\u0637"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u0648\u062d\u062f\u0629"}),S&&(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u0633\u0639\u0631"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u0645\u062e\u0632\u0648\u0646"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u062d\u0627\u0644\u0629"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right text-sm font-medium",children:"\u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a"})]})}),(0,l.jsx)("tbody",{children:T.map((e=>{const i=B(e);return(0,l.jsxs)("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors",children:[(0,l.jsxs)("td",{className:"px-6 py-4",children:[(0,l.jsx)("div",{className:"font-medium",children:e.name}),(0,l.jsx)("div",{className:"text-sm opacity-75",children:e.description})]}),(0,l.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,l.jsx)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-300 rounded-full text-xs",children:e.category||"-"})}),(0,l.jsx)("td",{className:"px-6 py-4 text-sm",children:e.line_name||"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"}),(0,l.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,l.jsx)("span",{className:"px-2 py-1 bg-gray-500/20 text-gray-300 rounded text-xs",children:e.unit})}),S&&(0,l.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("span",{className:"font-medium",children:[e.price," \u062c.\u0645"]}),(0,l.jsx)("span",{className:"text-xs opacity-60",children:(n=e.price_type,{per_vial:"\u0633\u0639\u0631 \u0627\u0644\u06a4\u0627\u064a\u0644",per_box:"\u0633\u0639\u0631 \u0627\u0644\u0639\u0644\u0628\u0629",per_pen:"\u0633\u0639\u0631 \u0627\u0644\u0642\u0644\u0645",per_tube:"\u0633\u0639\u0631 \u0627\u0644\u0623\u0646\u0628\u0648\u0628",per_bottle:"\u0633\u0639\u0631 \u0627\u0644\u0632\u062c\u0627\u062c\u0629"}[n]||"\u0633\u0639\u0631 \u0627\u0644\u0648\u062d\u062f\u0629")})]})}),(0,l.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,l.jsxs)("div",{className:"inline-block px-3 py-1 rounded-lg border text-center ".concat(E(i)),children:[(0,l.jsx)("div",{className:"font-medium",children:e.current_stock}),(0,l.jsxs)("div",{className:"text-xs",children:["\u0627\u0644\u062d\u062f \u0627\u0644\u0623\u062f\u0646\u0649: ",e.min_stock]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,l.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs ".concat(e.is_active?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:e.is_active?"\u0646\u0634\u0637":"\u063a\u064a\u0631 \u0646\u0634\u0637"})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>{y(e),v(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs",children:"\u062a\u0639\u062f\u064a\u0644"}),(0,l.jsx)("button",{onClick:()=>(async e=>{const i=d.find((t=>t.id===e));if(window.confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u0645\u0646\u062a\u062c\u061f"))try{const n=localStorage.getItem("access_token");console.log("\ud83d\udd27 Deleting product:",e);const r=await s.A.delete("".concat(C,"/products/").concat(e),{headers:{Authorization:"Bearer ".concat(n)}});console.log("\u2705 Product deleted successfully:",r.data),await a.a.logActivity("product_deletion","\u062d\u0630\u0641 \u0645\u0646\u062a\u062c","product",e,(null===i||void 0===i?void 0:i.name)||"\u0645\u0646\u062a\u062c ".concat(e),{deleted_product_name:null===i||void 0===i?void 0:i.name,deleted_product_price:null===i||void 0===i?void 0:i.price,deleted_product_unit:null===i||void 0===i?void 0:i.unit,deletion_reason:"\u062d\u0630\u0641 \u064a\u062f\u0648\u064a \u0645\u0646 \u0648\u0627\u062c\u0647\u0629 \u0627\u0644\u0625\u062f\u0627\u0631\u0629",deleted_by_role:null===t||void 0===t?void 0:t.role,stock_at_deletion:(null===i||void 0===i?void 0:i.stock_quantity)||0}),I(),alert("\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0645\u0646\u062a\u062c \u0628\u0646\u062c\u0627\u062d")}catch(o){var n,r;console.error("\u274c Error deleting product:",o);const e=(null===(n=o.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.detail)||"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0630\u0641 \u0627\u0644\u0645\u0646\u062a\u062c";alert("\u062e\u0637\u0623 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u0645\u0646\u062a\u062c: ".concat(e))}})(e.id),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-xs",children:"\u062d\u0630\u0641"})]})})]},e.id);var n}))})]})})}),0===T.length&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udce6"}),(0,l.jsx)("h3",{className:"text-xl font-bold mb-2",children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u0646\u062a\u062c\u0627\u062a"}),(0,l.jsx)("p",{className:"text-gray-600",children:"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0645\u0646\u062a\u062c\u0627\u062a \u0645\u0637\u0627\u0628\u0642\u0629 \u0644\u0644\u0628\u062d\u062b"})]}),x&&(0,l.jsx)(c,{product:b,lines:m,onClose:()=>v(!1),onSave:b?e=>(async(e,i)=>{try{const n=d.find((t=>t.id===e)),r=localStorage.getItem("access_token");console.log("\ud83d\udd27 Updating product:",e,"with data:",i);const o=await s.A.put("".concat(C,"/products/").concat(e),i,{headers:{Authorization:"Bearer ".concat(r)}});console.log("\u2705 Product updated successfully:",o.data),await a.a.logProductUpdate(e,(null===n||void 0===n?void 0:n.name)||i.name,{old_price:null===n||void 0===n?void 0:n.price,new_price:i.price,old_unit:null===n||void 0===n?void 0:n.unit,new_unit:i.unit,changeReason:"\u062a\u062d\u062f\u064a\u062b \u064a\u062f\u0648\u064a \u0645\u0646 \u0648\u0627\u062c\u0647\u0629 \u0627\u0644\u0625\u062f\u0627\u0631\u0629",updateType:"manual_update",updated_fields:Object.keys(i),updated_by_role:null===t||void 0===t?void 0:t.role}),I(),v(!1),alert("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0646\u062a\u062c \u0628\u0646\u062c\u0627\u062d")}catch(o){var n,r;console.error("\u274c Error updating product:",o);const e=(null===(n=o.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.detail)||"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0646\u062a\u062c";alert("\u062e\u0637\u0623 \u0641\u064a \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0646\u062a\u062c: ".concat(e))}})(b.id,e):async e=>{try{const i=localStorage.getItem("access_token");console.log("\ud83d\udd27 Creating product with data:",e);const n=await s.A.post("".concat(C,"/products"),e,{headers:{Authorization:"Bearer ".concat(i)}});console.log("\u2705 Product created successfully:",n.data),await a.a.logActivity("product_creation","\u0625\u0646\u0634\u0627\u0621 \u0645\u0646\u062a\u062c \u062c\u062f\u064a\u062f","product",n.data.id,e.name,{price:e.price,unit:e.unit,line_id:e.line_id,category:e.category,stock_quantity:e.stock_quantity||0,created_by_role:null===t||void 0===t?void 0:t.role}),I(),v(!1),alert("\u062a\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u0646\u062a\u062c \u0628\u0646\u062c\u0627\u062d")}catch(r){var i,n;console.error("\u274c Error creating product:",r);const e=(null===(i=r.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.detail)||"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u0646\u062a\u062c";alert("\u062e\u0637\u0623 \u0641\u064a \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u0646\u062a\u062c: ".concat(e))}},language:i})]})}},269:(e,t,i)=>{i.d(t,{a:()=>o});var n=i(555),r=i(722);const o=new class{constructor(){this.API="https://6fc37004-de78-473a-b926-f0438820a235.preview.emergentagent.com/api",this.isEnabled=!0,this.currentPosition=null,this.retryQueue=[]}async getCurrentPosition(){if(!navigator.geolocation)return console.warn("Geolocation is not supported"),null;try{const t=await new Promise(((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e5})}));this.currentPosition={latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy,altitude:t.coords.altitude,speed:t.coords.speed,heading:t.coords.heading,timestamp:(new Date).toISOString()};try{const e=await this.getAddressFromCoordinates(t.coords.latitude,t.coords.longitude);this.currentPosition.address=e.formatted_address,this.currentPosition.city=e.city,this.currentPosition.area=e.area,this.currentPosition.country=e.country}catch(e){console.warn("Failed to get address from coordinates:",e),this.currentPosition.address="".concat(t.coords.latitude.toFixed(4),", ").concat(t.coords.longitude.toFixed(4))}return this.currentPosition}catch(e){return console.warn("Failed to get current position:",e),null}}async getAddressFromCoordinates(e,t){const i="AIzaSyDzxZjDxPdcrnGKb66mT5BIvQzQWcnLp70";try{const n=await fetch("https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(e,",").concat(t,"&key=").concat(i,"&language=ar")),r=await n.json();if(r.results&&r.results.length>0){const e=r.results[0];return{formatted_address:e.formatted_address,city:this.extractAddressComponent(e,"locality")||this.extractAddressComponent(e,"administrative_area_level_2"),area:this.extractAddressComponent(e,"administrative_area_level_3")||this.extractAddressComponent(e,"sublocality"),country:this.extractAddressComponent(e,"country")||"\u0645\u0635\u0631"}}}catch(n){console.warn("Geocoding failed:",n)}return{formatted_address:"".concat(e.toFixed(4),", ").concat(t.toFixed(4)),city:"",area:"",country:"\u0645\u0635\u0631"}}extractAddressComponent(e,t){const i=e.address_components.find((e=>e.types.includes(t)));return i?i.long_name:""}getDeviceInfo(){const e=navigator.userAgent;return{device_type:this.getDeviceType(),operating_system:this.getOperatingSystem(),browser:this.getBrowserInfo(),browser_version:this.getBrowserVersion(),user_agent:e,screen_resolution:"".concat(window.screen.width,"x").concat(window.screen.height),viewport_size:"".concat(window.innerWidth,"x").concat(window.innerHeight),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language,online:navigator.onLine}}getDeviceType(){const e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?"mobile":"desktop"}getOperatingSystem(){const e=navigator.userAgent,t=[{name:"Windows 11",regex:/Windows NT 10\.0.*rv:91/},{name:"Windows 10",regex:/Windows NT 10\.0/},{name:"Windows 8.1",regex:/Windows NT 6\.3/},{name:"Windows 8",regex:/Windows NT 6\.2/},{name:"Windows 7",regex:/Windows NT 6\.1/},{name:"macOS",regex:/Mac OS X/},{name:"iOS",regex:/(iPhone|iPad|iPod)/},{name:"Android",regex:/Android/},{name:"Linux",regex:/Linux/},{name:"Unix",regex:/X11/}];for(const i of t)if(i.regex.test(e))return i.name;return"Unknown"}getBrowserInfo(){const e=navigator.userAgent,t=[{name:"Chrome",regex:/Chrome/},{name:"Firefox",regex:/Firefox/},{name:"Safari",regex:/Safari/},{name:"Edge",regex:/Edge/},{name:"Opera",regex:/Opera/},{name:"Internet Explorer",regex:/MSIE/}];for(const i of t)if(i.regex.test(e))return i.name;return"Unknown"}getBrowserVersion(){const e=navigator.userAgent.match(/(Chrome|Firefox|Safari|Edge|Opera)\/(\d+\.\d+)/);return e?e[2]:"Unknown"}async logActivity(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(this.isEnabled)try{var l;const c=localStorage.getItem("access_token");if(!c)return void console.warn("No access token available for activity logging");const d={type:e,action:t,target_type:i,target_id:o,target_name:s,location:await this.getCurrentPosition(),device_info:this.getDeviceInfo(),details:(0,n.A)((0,n.A)({},a),{},{page_url:window.location.href,page_title:document.title,referrer:document.referrer,session_storage_length:sessionStorage.length,local_storage_length:localStorage.length}),metadata:{logged_at:(new Date).toISOString(),user_agent:navigator.userAgent,connection_type:(null===(l=navigator.connection)||void 0===l?void 0:l.effectiveType)||"unknown",battery_level:navigator.getBattery?await navigator.getBattery().then((e=>e.level)):null}},u=await r.A.post("".concat(this.API,"/activities"),d,{headers:{Authorization:"Bearer ".concat(c),"Content-Type":"application/json"},timeout:1e4});return console.log("Activity logged successfully:",u.data),u.data}catch(c){console.error("Failed to log activity:",c),this.retryQueue.push({type:e,action:t,targetType:i,targetId:o,targetName:s,details:a,timestamp:(new Date).toISOString(),retryCount:0}),this.scheduleRetry()}}scheduleRetry(){0!==this.retryQueue.length&&setTimeout((async()=>{const e=this.retryQueue.shift();if(e&&e.retryCount<3){e.retryCount++;try{await this.logActivity(e.type,e.action,e.targetType,e.targetId,e.targetName,e.details)}catch(t){e.retryCount<3&&this.retryQueue.push(e)}}}),5e3)}async logVisitRegistration(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.logActivity("visit_registration","\u062a\u0633\u062c\u064a\u0644 \u0632\u064a\u0627\u0631\u0629 \u0639\u064a\u0627\u062f\u0629","clinic",e,t,(0,n.A)({visit_duration:i.duration||null,doctor_present:i.doctorPresent||null,samples_given:i.samplesGiven||0,notes:i.notes||"",visit_type:i.type||"routine"},i))}async logClinicRegistration(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.logActivity("clinic_registration","\u062a\u0633\u062c\u064a\u0644 \u0639\u064a\u0627\u062f\u0629 \u062c\u062f\u064a\u062f\u0629","clinic",e,t,(0,n.A)({doctor_name:i.doctorName||"",specialty:i.specialty||"",classification:i.classification||"",phone:i.phone||"",address:i.address||""},i))}async logOrderCreation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.logActivity("order_creation","\u0625\u0646\u0634\u0627\u0621 \u0637\u0644\u0628 \u062c\u062f\u064a\u062f","order",e,"\u0637\u0644\u0628 \u0631\u0642\u0645 ".concat(e),(0,n.A)({order_value:t.totalValue||0,items_count:t.itemsCount||0,clinic_name:t.clinicName||"",payment_method:t.paymentMethod||""},t))}async logProductUpdate(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.logActivity("product_update","\u062a\u062d\u062f\u064a\u062b \u0645\u0646\u062a\u062c","product",e,t,(0,n.A)({old_price:i.oldPrice||null,new_price:i.newPrice||null,change_reason:i.changeReason||"",update_type:i.updateType||"general"},i))}async logUserCreation(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.logActivity("user_creation","\u0625\u0646\u0634\u0627\u0621 \u0645\u0633\u062a\u062e\u062f\u0645 \u062c\u062f\u064a\u062f","user",e,t,(0,n.A)({user_role:i.role||"",department:i.department||"",permissions:i.permissions||[]},i))}async logSystemAccess(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.logActivity("system_access","\u062f\u062e\u0648\u0644 \u0642\u0633\u0645 ".concat(e),"system",e,"\u0642\u0633\u0645 ".concat(e),(0,n.A)({access_time:(new Date).toISOString(),previous_section:t.previousSection||"",access_method:t.accessMethod||"navigation"},t))}async logLogin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.logActivity("login","\u062a\u0633\u062c\u064a\u0644 \u062f\u062e\u0648\u0644","system","login","\u0646\u0638\u0627\u0645 EP Group",(0,n.A)({login_method:e.method||"password",biometric_verified:e.biometricVerified||!1,failed_attempts:e.failedAttempts||0,remember_me:e.rememberMe||!1},e))}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}clearRetryQueue(){this.retryQueue=[]}}}}]);
//# sourceMappingURL=982.ad54840e.chunk.js.map